<h1>Home</h1>

<div>Hello, <img class="br2 small-image" src="{{$ctrl.user.img}}"> {{$ctrl.user.first_name}} {{$ctrl.user.last_name}}!</div>

<div class="container">
  <div class="f3 ml4">Feed</div>
  <button class="ml4" ui-sref="write">Add new post</button>

  <div class="ba br2 b--light-gray ma2" ng-repeat="post in $ctrl.feed | orderBy: 'created_at' : true">
    <div class="pa2 ph3-ns pb3-ns">
      <div class="dt w-100 mt1">
        <div class="post-head">
          <div class="f5 mv0 mid-gray dib">
            <div class="small-img dib">
              <a ui-sref="profile({id: post.user_id})"><img class="br2 small-image" src="{{post.img}}"></a>
            </div>

            <div class="dib">
            <a ui-sref="profile({id: post.user_id})" class="mid-gray">{{post.first_name}} {{post.last_name}}</a>

              <div class="f6">posted <span am-time-ago="post.created_at"></span></div>
            </div>

          </div>
          <div class="b tr dib post-style">
            <span ng-pluralize count="post.styles.length"
            when="{'0': '',
                    '1': '{{post.styles[0].name}}',
                    '2': '{{post.styles[0].name}}, {{post.styles[1].name}}',
                    '3': '{{post.styles[0].name}}, {{post.styles[1].name}}, {{post.styles[2].name}}'}"></span>
          </div>
        </div>

        <div class="mt3">
          <h1 class="f4 mv0">{{post.post_location}}</h1>
        </div>
      </div>
      <p class="f6 lh-copy mt2">
        {{post.content}}
      </p>
      <div class="mb3" ng-if="post.images.length">
        <img class="br2 center" src="{{post.images[0].url}}">

      </div>
      <div class="f6 mv3 mid-gray" ng-if="post.comments.length">
        <a ng-click="$ctrl.toggleComments(post)" ng-pluralize count="post.comments.length"
          when="{'0': 'No comments yet',
                  '1': '{{post.comments.length}} comment',
                  'other': '{{post.comments.length}} comments'}"></a>
      </div>
      <div class="f6 mb2" ng-if="post.showComments" ng-repeat="comment in post.comments">
        <div>
          <a ui-sref="profile({id: comment.user_id})" class="b black">{{comment.first_name}} {{comment.last_name}}</a> {{comment.content}}
        </div>
      </div>
      <form ng-submit="$ctrl.postComment(post)">
        <input class="f6 br2 mt1 w-40" placeholder="add a comment" ng-model="post.commentInput"></input>
      </form>
    </div>
  </div>
</div>
